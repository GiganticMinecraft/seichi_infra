FROM ghcr.io/giganticminecraft/mod-downloader:sha-39a89de as mod-downloader

FROM ghcr.io/giganticminecraft/seichi_minecraft_server_base:1.0.0-java17-jdk@sha256:57accce4686dfe6bf6cb5107a664b169f130e97ef697ea7b37778a14e7f942e6

ARG MINIO_ENDPOINT
ARG MINIO_ACCESS_KEY
ARG MINIO_ACCESS_SECRET
ARG BUCKET_NAME
ARG BUCKET_PREFIX_NAME
ARG DOWNLOAD_TARGET_DIR_PATH

ENV VERSION="1.18.2"

# プラグインリスト
#   このイメージでは基底のリスト (/extras/plugin-list.ini) に追記する
COPY --link ./additional-plugin-list.ini /extras/additional-plugin-list.ini
RUN /bin/bash -c "cat /extras/additional-plugin-list.ini >> /extras/plugin-list.ini"

COPY --from=mod-downloader ./bin/ /
RUN /mod-downloader

# プラグインの設定ファイル
COPY --link ./additional-plugin-configs /plugins

###
# 環境変数として指定されるべきプラグインの設定
#
ENV CFG_REPLACEMENT__COREPROTECT_MYSQL_HOST=""
ENV CFG_REPLACEMENT__COREPROTECT_MYSQL_PORT=""
ENV CFG_REPLACEMENT__COREPROTECT_MYSQL_USER=""
ENV CFG_REPLACEMENT__COREPROTECT_MYSQL_PASSWORD=""

ENV CFG_REPLACEMENT__DYNMAP_WEBPAGE_TITLE=""

ENV CFG_REPLACEMENT__LAGMONITOR_MYSQL_HOST=""
ENV CFG_REPLACEMENT__LAGMONITOR_MYSQL_PORT=""
ENV CFG_REPLACEMENT__LAGMONITOR_MYSQL_USER=""
ENV CFG_REPLACEMENT__LAGMONITOR_MYSQL_PASSWORD=""

ENV CFG_REPLACEMENT__LITEBANS_SERVER_NAME=""
ENV CFG_REPLACEMENT__LITEBANS_MYSQL_ADDRESS=""
ENV CFG_REPLACEMENT__LITEBANS_MYSQL_USER=""
ENV CFG_REPLACEMENT__LITEBANS_MYSQL_PASSWORD=""

ENV CFG_REPLACEMENT__PERMISSIONSEX_MYSQL_URL=""
ENV CFG_REPLACEMENT__PERMISSIONSEX_MYSQL_USER=""
ENV CFG_REPLACEMENT__PERMISSIONSEX_MYSQL_PASSWORD=""

# e.g. "9225"
ENV CFG_REPLACEMENT__PROMETHEUS_EXPORTER_PORT=""

# originally it was "\\192.168.xxx.xxx\seichi-share\schematics"
ENV CFG_REPLACEMENT__WORLDEDIT_SCHEMATICS_DIRECTORY=""

ENV CFG_REPLACEMENT__SEICHIASSIST_DB_HOST=""
ENV CFG_REPLACEMENT__SEICHIASSIST_DB_PORT=""
ENV CFG_REPLACEMENT__SEICHIASSIST_DB_USER=""
ENV CFG_REPLACEMENT__SEICHIASSIST_DB_PASSWORD=""

ENV CFG_REPLACEMENT__SEICHIASSIST_SERVER_NUM=""
ENV CFG_REPLACEMENT__SEICHIASSIST_SERVER_ID=""

# Discord のチャットチャンネルへの Webhook
ENV CFG_REPLACEMENT__SEICHIASSIST_URL_WEBHOOK_NOTIFICATION=""

ENV CFG_REPLACEMENT__SEICHIASSIST_REDISBUNGEE_REDIS_HOST=""
ENV CFG_REPLACEMENT__SEICHIASSIST_REDISBUNGEE_REDIS_PORT=""

ENV CFG_REPLACEMENT__SEICHIASSIST_BUNGEESEMAPHORE_RESPONDER_REDIS_HOST=""
ENV CFG_REPLACEMENT__SEICHIASSIST_BUNGEESEMAPHORE_RESPONDER_REDIS_PORT=""

###
